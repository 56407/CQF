In [335]: DF
Out[335]:
      0.0       0.5       1.0       1.5       2.0       2.5       3.0  \
Tenor
0.0     0  0.997885  0.995749  0.993131  0.990013   0.98648  0.982581
0.5     0         0   0.99786  0.995237  0.992111  0.988571  0.984664
1.0     0         0         0  0.997371  0.994239  0.990691  0.986776
1.5     0         0         0         0   0.99686  0.993302  0.989377
2.0     0         0         0         0         0  0.996431  0.992494
2.5     0         0         0         0         0         0  0.996048
3.0     0         0         0         0         0         0         0
3.5     0         0         0         0         0         0         0
4.0     0         0         0         0         0         0         0
4.5     0         0         0         0         0         0         0
5.0     0         0         0         0         0         0         0

            3.5       4.0       4.5       5.0
Tenor
0.0    0.978317   0.97366  0.968578  0.963044
0.5    0.980391  0.975725  0.970631  0.965086
1.0    0.982494  0.977817  0.972713  0.967155
1.5    0.985084  0.980395  0.975277  0.969705
2.0    0.988187  0.983483  0.978349  0.972759
2.5    0.991726  0.987005  0.981853  0.976243
3.0    0.995661  0.990921  0.985748  0.980116
3.5           0   0.99524  0.990044  0.984388
4.0           0         0   0.99478  0.989096
4.5           0         0         0  0.994287
5.0           0         0         0         0


In [316]: (L_plus - K_plus)
Out[316]:
           Sim1      Sim2      Sim3      Sim4      Sim5
Tenor
0.0    0.000000  0.000000  0.000000  0.000000  0.000000
0.5    0.002240  0.003735 -0.002367  0.001750  0.002736
1.0    0.006841  0.002495 -0.002149  0.002655  0.008992
1.5    0.010624  0.003232  0.003770  0.000098  0.009399
2.0    0.013838 -0.000667 -0.003367  0.000708  0.011027
2.5    0.018786  0.001180 -0.007539  0.000677  0.016133
3.0    0.022471 -0.001599 -0.009960  0.001046  0.014515
3.5    0.030686 -0.014285 -0.012357 -0.002002  0.019025
4.0    0.032909 -0.022254 -0.013427  0.003459  0.026946
4.5    0.041279 -0.029197 -0.015626  0.008547  0.029599
5.0    0.050581 -0.022038 -0.005388  0.006180  0.035560

In [334]: V_plus
Out[334]:
            Sim1       Sim2        Sim3        Sim4       Sim5
Tenor
0.0     0.112333 -0.0383962  -0.0334008    0.011261  0.0849378
0.5     0.111451 -0.0403451   -0.032288   0.0104097  0.0837497
1.0      0.10827  -0.041679  -0.0312827  0.00910468  0.0794335
1.5     0.103243 -0.0434047  -0.0332501  0.00907973  0.0749432
2.0    0.0966492 -0.0432077  -0.0316714  0.00875446  0.0696659
2.5    0.0876026 -0.0439526  -0.0280156  0.00844738  0.0618488
3.0    0.0767146 -0.0433273  -0.0231467  0.00795803  0.0548368
3.5     0.061706 -0.0363736  -0.0170689   0.0089935  0.0455632
4.0    0.0455465 -0.0254208  -0.0104371  0.00730706  0.0323081
4.5     0.025146 -0.0109559 -0.00267881   0.0030721  0.0176782
5.0            0          0           0           0          0

##########################################################################

New DFs using implied from Libor curve

In [50]: DF
Out[50]:
      0.0       0.5       1.0       1.5       2.0       2.5       3.0  \
Tenor
0.0     1  0.995569  0.990377  0.984752  0.978702  0.972172  0.965249
0.5     0         1  0.994784  0.989135  0.983058  0.976498  0.969545
1.0     0         0         1  0.994321  0.988212  0.981618  0.974629
1.5     0         0         0         1  0.993857  0.987225  0.980196
2.0     0         0         0         0         1  0.993327  0.986255
2.5     0         0         0         0         0         1   0.99288
3.0     0         0         0         0         0         0         1
3.5     0         0         0         0         0         0         0
4.0     0         0         0         0         0         0         0
4.5     0         0         0         0         0         0         0
5.0     0         0         0         0         0         0         0

            3.5       4.0       4.5       5.0
Tenor
0.0    0.958186  0.950754  0.942848  0.934499
0.5    0.962451  0.954985  0.947044  0.938658
1.0    0.967497  0.959992  0.952009   0.94358
1.5    0.973023  0.965476  0.957447  0.948969
2.0    0.979038  0.971444  0.963365  0.954835
2.5    0.985614  0.977969  0.969837  0.961249
3.0    0.992683  0.984983  0.976792  0.968143
3.5           1  0.992243  0.983992  0.975279
4.0           0         1  0.991684  0.982903
4.5           0         0         1  0.991146
5.0           0         0         0         1

############################################################################

In [71]: EE_plus_median
Out[71]:
masked_array(data = [0.06209215012430824 0.058930440219944896 0.05563720516919488
 0.05171324024755412 0.047456955112243036 0.042188252815434465
 0.03597819794430981 0.028971695620116283 0.01974487992574897
 0.01081108221390057],
             mask = [False False False False False False False False False False],
       fill_value = ?)

In [62]: np.percentile(x, q=97.5, axis=1)
Out[62]:
array([0.15920205724326678, 0.15440996125576734, 0.14630137892787443,
       0.137461792978582, 0.12728404392765125, 0.11546597736307034,
       0.10150253186554131, 0.07970566102364415, 0.05550838141190473,
       0.028094287607002607, 0.0], dtype=object)
